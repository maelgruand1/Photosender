<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Photosender</title>
    <link rel="stylesheet" href="styles.css" />
    <!-- Inclure Firebase App -->
    <!-- Inclure Firebase App -->
    <script
      defer
      type="module"
      src="https://www.gstatic.com/firebasejs/10.3.0/firebase-app.js"
    ></script>
    <!-- Inclure Firebase Auth -->
    <script
      defer
      type="module"
      src="https://www.gstatic.com/firebasejs/10.3.0/firebase-auth.js"
    ></script>
    <!-- Inclure Firebase Storage -->
    <script
      defer
      type="module"
      src="https://www.gstatic.com/firebasejs/10.3.0/firebase-storage.js"
    ></script>
    <!-- Ton script JS avec la logique d'application -->
    <script defer type="module" src="script.js"></script>

    <!-- Ton script JS avec la logique d'application -->
    <script defer src="script.js"></script>

    <link rel="icon" href="PS.png" class="logo" />
  </head>
  <body>
    <header>
      <h1 class="title">Photosender</h1>
      <div id="profile-logo" class="hidden">
        <span id="profile-icon">üë§</span>
        <span id="profile-username"></span>
      </div>
    </header>

    <nav class="navbar">
      <ul>
        <li>
          <a href="#" data-section="home">Home</a>
          <a href="#" data-section="about">About</a>
          <a href="#" data-section="login">Login</a>
          <a href="#" data-section="photos" class="hidden" id="photosLink"
            >Photos</a
          >
        </li>
      </ul>
    </nav>

    <main>
      <!-- Section Home -->
      <section id="home" class="active">
        <div>
          <h2>Home</h2>
          <p>
            Bienvenue sur Photosender, votre solution pour envoyer et partager
            vos photos en toute simplicit√© !
          </p>
          <button class="action-btn">Commencez Maintenant</button>
        </div>
      </section>

      <!-- Section About -->
      <section id="about" class="hidden">
        <h2>√Ä propos de Photosender</h2>
        <p>
          Photosender est une plateforme innovante con√ßue pour faciliter le
          partage de vos photos avec vos amis, votre famille ou vos coll√®gues.
          Que vous souhaitiez envoyer une seule image ou cr√©er une galerie,
          Photosender est fait pour vous !
        </p>
      </section>

      <!-- Section Login -->
      <section id="login" class="hidden">
        <div class="login-container">
          <h2>Connexion</h2>
          <form id="login-form">
            <input type="email" id="email" placeholder="E-mail" required />
            <input
              type="password"
              id="password"
              placeholder="Mot de passe"
              required
            />
            <button type="submit">Se connecter</button>
          </form>
          <p id="status"></p>
        </div>
        <p class="signup-text">
          Pas encore inscrit ? <a href="#">Cr√©er un compte</a>
        </p>
      </section>

      <!-- Section Photos -->
      <section id="photos" class="hidden">
        <h2>Galerie de photos</h2>
        <button onclick="loadPhotos()">Charger les photos</button>
        <div id="photoGallery" class="gallery">
          <div class="photos"></div>
        </div>
      </section>
    </main>

    <footer>
      <p>&copy; 2024 - Photosender.</p>
    </footer>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyAb6k8Q3G39ZLAsSOCUx0A-bX3J8b9ifak",
        authDomain: "photosenderwebapp.firebaseapp.com",
        projectId: "photosenderwebapp",
        storageBucket: "photosenderwebapp.firebasestorage.app",
        messagingSenderId: "575206578690",
        appId: "1:575206578690:web:829160d554049ab1a2a51b",
        measurementId: "G-C9VZNKSQ30",
      };

      // Initialize Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const storage = firebase.storage();

      // Change section visibility
      function changeSection(section) {
        const sections = document.querySelectorAll("main section");
        sections.forEach((sec) => {
          sec.classList.add("hidden");
        });
        document.getElementById(section).classList.remove("hidden");
      }

      // Navigation between sections
      document.querySelectorAll(".navbar a").forEach((link) => {
        link.addEventListener("click", (e) => {
          const section = e.target.getAttribute("data-section");
          changeSection(section);
        });
      });

      // Login form
      document
        .getElementById("login-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const email = document.getElementById("email").value;
          const password = document.getElementById("password").value;

          auth
            .signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
              document.getElementById("status").textContent =
                "Connexion r√©ussie !";
              document.getElementById("photosLink").classList.remove("hidden");
              changeSection("photos");
            })
            .catch((error) => {
              document.getElementById("status").textContent =
                "Erreur de connexion.";
              console.error(error);
            });
        });

      // Load photos
      function loadPhotos() {
        google.script.run
          .withSuccessHandler(function (urls) {
            var galleryDiv = document.querySelector("#photoGallery .photos");
            galleryDiv.innerHTML = ""; // Clear existing photos

            urls.forEach(function (url) {
              var imgElement = document.createElement("img");
              imgElement.src = url;
              galleryDiv.appendChild(imgElement);
            });
          })
          .getPhotosLinks(); // Call Google Apps Script to get photos
      }
    </script>
  </body>
</html>
